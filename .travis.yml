language: java
dist: trusty
jdk:
  - oraclejdk8
#env:
#  - TESTFOLDER=./monolithic/ui
#  - TESTFOLDER=./monolithic/service/cart
#  - TESTFOLDER=./monolithic/service/user
#  - TESTFOLDER=./monolithic/repository/order
#  - TESTFOLDER=./monolithic/repository/cart
#  - TESTFOLDER=./monolithic/repository/product
#  - TESTFOLDER=./monolithic/repository/user

install:
  - ./gradlew clean jar

jobs:
  include:
    - script: "COVERAGE=0.05 ./gradlew -p ./monolithic/ui check" #0.05773373545885394000000000
    - script: "COVERAGE=0.14 ./gradlew -p ./monolithic/service/cart check" #0.14843750000000000000000000
    - script: "COVERAGE=0.0 ./gradlew -p ./monolithic/service/user check" #0.00000
    - script: "COVERAGE=0.0 ./gradlew -p ./monolithic/repository/order check" #0.000000
    - script: "COVERAGE=0.0 ./gradlew -p ./monolithic/repository/cart check" #0.00000
    - script: "COVERAGE=0.12 ./gradlew -p ./monolithic/repository/product check" #0.12452107279693486000000000
    - script: "COVERAGE=0.30 ./gradlew -p ./monolithic/repository/user check"


deploy:
  - provider: script
    script: deploy_production.sh
    on:
      branch: final_step4_test-deploy
